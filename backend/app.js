import express from "express";
const app = express();

// EXPRESS SETTINGS
app.set("json spaces", 2); // prettify responsed json

// MIDDLEWARES
import cors from "cors";
import helmet from "helmet";
import morgan from "morgan";
app.use(cors()); // https://www.npmjs.com/package/cors | http://en.wikipedia.org/wiki/Cross-origin_resource_sharing
app.use(helmet()); // https://expressjs.com/ru/advanced/best-practice-security.html#%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-helmet
app.use(morgan('dev')); // a great http logger | https://www.npmjs.com/package/morgan
app.use(express.json()); // parse application/json requests
app.use(express.static('./public')); // serve static files from public folder | like images, css, js and else
// TODO: express-rate-limit, express-slow-down

// ROUTES
import usersRouter from "./routes/users.js"
import keysRouter from "./routes/keys.js"
app.use(usersRouter);
app.use(keysRouter);

// DEFAULT ROUTES
app.get("/", (req, res) => {
	res.status(200).send(`<pre> __     __     ______     __         ______     ______     __    __     ______           ______   ______           ______     ______     __   __     ______     ______   ______     ______     _____     ______    
/\\ \\  _ \\ \\   /\\  ___\\   /\\ \\       /\\  ___\\   /\\  __ \\   /\\ "-./  \\   /\\  ___\\         /\\__  _\\ /\\  __ \\         /\\  ___\\   /\\  __ \\   /\\ "-.\\ \\   /\\  ___\\   /\\__  _\\ /\\  ___\\   /\\  __ \\   /\\  __-.  /\\  ___\\   
\\ \\ \\/ ".\\ \\  \\ \\  __\\   \\ \\ \\____  \\ \\ \\____  \\ \\ \\/\\ \\  \\ \\ \\-./\\ \\  \\ \\  __\\         \\/_/\\ \\/ \\ \\ \\/\\ \\        \\ \\ \\____  \\ \\ \\/\\ \\  \\ \\ \\-.  \\  \\ \\___  \\  \\/_/\\ \\/ \\ \\ \\____  \\ \\ \\/\\ \\  \\ \\ \\/\\ \\ \\ \\  __\\   
 \\ \\__/".~\\_\\  \\ \\_____\\  \\ \\_____\\  \\ \\_____\\  \\ \\_____\\  \\ \\_\\ \\ \\_\\  \\ \\_____\\          \\ \\_\\  \\ \\_____\\        \\ \\_____\\  \\ \\_____\\  \\ \\_\\\\"\\_\\  \\/\\_____\\    \\ \\_\\  \\ \\_____\\  \\ \\_____\\  \\ \\____-  \\ \\_____\\ 
  \\/_/   \\/_/   \\/_____/   \\/_____/   \\/_____/   \\/_____/   \\/_/  \\/_/   \\/_____/           \\/_/   \\/_____/         \\/_____/   \\/_____/   \\/_/ \\/_/   \\/_____/     \\/_/   \\/_____/   \\/_____/   \\/____/   \\/_____/ 
                                                                                                                                                                                                                   
   __     ______     ______     __   __        ______     ______     ______     __   __   ______     ______        __    __     ______     __   __     ______     ______     ______     ______    
  /\\ \\   /\\  ___\\   /\\  __ \\   /\\ "-.\\ \\      /\\  ___\\   /\\  ___\\   /\\  == \\   /\\ \\ / /  /\\  ___\\   /\\  == \\      /\\ "-./  \\   /\\  __ \\   /\\ "-.\\ \\   /\\  __ \\   /\\  ___\\   /\\  ___\\   /\\  == \\   
 _\\_\\ \\  \\ \\___  \\  \\ \\ \\/\\ \\  \\ \\ \\-.  \\     \\ \\___  \\  \\ \\  __\\   \\ \\  __<   \\ \\ \\'/   \\ \\  __\\   \\ \\  __<      \\ \\ \\-./\\ \\  \\ \\  __ \\  \\ \\ \\-.  \\  \\ \\  __ \\  \\ \\ \\__ \\  \\ \\  __\\   \\ \\  __<   
/\\_____\\  \\/\\_____\\  \\ \\_____\\  \\ \\_\\\\"\\_\\     \\/\\_____\\  \\ \\_____\\  \\ \\_\\ \\_\\  \\ \\__|    \\ \\_____\\  \\ \\_\\ \\_\\     \\ \\_\\ \\ \\_\\  \\ \\_\\ \\_\\  \\ \\_\\\\"\\_\\  \\ \\_\\ \\_\\  \\ \\_____\\  \\ \\_____\\  \\ \\_\\ \\_\\ 
\\/_____/   \\/_____/   \\/_____/   \\/_/ \\/_/      \\/_____/   \\/_____/   \\/_/ /_/   \\/_/      \\/_____/   \\/_/ /_/      \\/_/  \\/_/   \\/_/\\/_/   \\/_/ \\/_/   \\/_/\\/_/   \\/_____/   \\/_____/   \\/_/ /_/ 
</pre>`);
});

app.use((req, res, next) => {
	res.status(404).send(`<pre>                                                                                                                                                                          
        ,d8       ,a8888a,             ,d8        888b      88    ,ad8888ba,    888888888888      88888888888    ,ad8888ba,    88        88  888b      88  88888888ba,    
      ,d888     ,8P"'  \`"Y8,         ,d888        8888b     88   d8"'    \`"8b        88           88            d8"'    \`"8b   88        88  8888b     88  88      \`"8b   
    ,d8" 88    ,8P        Y8,      ,d8" 88        88 \`8b    88  d8'        \`8b       88           88           d8'        \`8b  88        88  88 \`8b    88  88        \`8b  
  ,d8"   88    88          88    ,d8"   88        88  \`8b   88  88          88       88           88aaaaa      88          88  88        88  88  \`8b   88  88         88  
,d8"     88    88          88  ,d8"     88        88   \`8b  88  88          88       88           88"""""      88          88  88        88  88   \`8b  88  88         88  
8888888888888  \`8b        d8'  8888888888888      88    \`8b 88  Y8,        ,8P       88           88           Y8,        ,8P  88        88  88    \`8b 88  88         8P  
         88     \`8ba,  ,ad8'            88        88     \`8888   Y8a.    .a8P        88           88            Y8a.    .a8P   Y8a.    .a8P  88     \`8888  88      .a8P   
         88       "Y8888P"              88        88      \`888    \`"Y8888Y"'         88           88             \`"Y8888Y"'     \`"Y8888Y"'   88      \`888  88888888Y"'    
</pre>`);
});

export default app;
